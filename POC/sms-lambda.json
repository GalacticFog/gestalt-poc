{
    "resource_type": "Gestalt::Resource::Node::Lambda",
    "name": "sms-notification",
    "description": "SMS Notification Lambda",
    "properties": {
        "env": {
            "phone": "REPLACE WITH PHONE NUMBER"
        },
        "headers": {
            "Accept": "text/plain",
            "Content-Type": "text/html"
        },
        "code": "ZnVuY3Rpb24gcnVuKGUsIGMpIHsKICAgIHZhciBjb250ZXh0ID0gSlNPTi5wYXJzZShjKTsKICAgIAogICAgaWYgKGNvbnRleHQubWV0aG9kID09ICdHRVQnKQogICAgICAgIHJldHVybiBnZXRIdG1sKCk7CgogICAgaWYgKGNvbnRleHQubWV0aG9kID09ICdQT1NUJykgewogICAgICAgIHZhciBldmVudCA9IEpTT04ucGFyc2UoZSk7CiAgICAgICAgcmV0dXJuIHNlbmRTbXMoY29udGV4dCwgZXZlbnQpOwogICAgfQoKICAgIHJldHVybiAiTWV0aG9kIG5vdCBmb3VuZCI7Cn0KCmZ1bmN0aW9uIHNlbmRTbXMoY29udGV4dCwgZXZlbnQpIHsKCiAgICB2YXIgcGhvbmUgPSBldmVudC5waG9uZSA/IGV2ZW50LnBob25lIDogamF2YS5sYW5nLlN5c3RlbS5nZXRlbnYoInBob25lIik7CgogICAgaWYgKCFwaG9uZSkKICAgICAgICByZXR1cm4gIkVycm9yOiBwaG9uZSBpcyBub3QgZGVmaW5lZCI7CiAgICB2YXIgbXNnID0gZXZlbnQubXNnOwogICAgaWYgKCFtc2cpCiAgICAgICAgcmV0dXJuICJFcnJvcjogbWVzc2FnZSBpcyBlbXB0eSI7CiAgICB2YXIgZXZlbnREYXRhID0KICAgICAgICB7CiAgICAgICAgICAgIHRvOiBwaG9uZSwKICAgICAgICAgICAgZnJvbTogIisxODQ4MjQyODIyMSIsCiAgICAgICAgICAgIHVzZXI6IGphdmEubGFuZy5TeXN0ZW0uZ2V0ZW52KCJ1c2VyIiksIAogICAgICAgICAgICBwd2Q6IGphdmEubGFuZy5TeXN0ZW0uZ2V0ZW52KCJwYXNzd29yZCIpLCAKICAgICAgICAgICAgYm9keTogbXNnCiAgICAgICAgfTsKCiAgICAvL2FkZCBhdXRoCQogICAgdmFyIHVzZXJwYXNzID0gZXZlbnREYXRhLnVzZXIgKyAiOiIgKyBldmVudERhdGEucHdkOwogICAgdmFyIGJhc2ljQXV0aCA9ICJCYXNpYyAiICsgamF2YS51dGlsLkJhc2U2NC5nZXRFbmNvZGVyKCkuZW5jb2RlVG9TdHJpbmcodXNlcnBhc3MuZ2V0Qnl0ZXMoKSk7CiAgICB2YXIgdSA9ICJodHRwczovL2FwaS50d2lsaW8uY29tLzIwMTAtMDQtMDEvQWNjb3VudHMvIiArIGV2ZW50RGF0YS51c2VyICsgIi9NZXNzYWdlcy8/VG89JTJCIiArIGV2ZW50RGF0YS50byArICImRnJvbT0lMkIiICsgZXZlbnREYXRhLmZyb207CiAgICB2YXIgQXN5bmNIdHRwQ2xpZW50ID0gSmF2YS50eXBlKCdvcmcuYXN5bmNodHRwY2xpZW50LkRlZmF1bHRBc3luY0h0dHBDbGllbnQnKTsKICAgIHZhciBDb21wbGV0YWJsZUZ1dHVyZSA9IEphdmEudHlwZSgnamF2YS51dGlsLmNvbmN1cnJlbnQuQ29tcGxldGFibGVGdXR1cmUnKTsKICAgIHZhciBjbGllbnQgPSBuZXcgQXN5bmNIdHRwQ2xpZW50KCk7CiAgICB2YXIgcGMgPSBjbGllbnQucHJlcGFyZVBvc3QodSkKICAgICAgICAuYWRkSGVhZGVyKCJBdXRob3JpemF0aW9uIiwgYmFzaWNBdXRoKQogICAgICAgIC5hZGRGb3JtUGFyYW0oIlRvIiwgZXZlbnREYXRhLnRvKQogICAgICAgIC5hZGRGb3JtUGFyYW0oIkZyb20iLCBldmVudERhdGEuZnJvbSkKICAgICAgICAuYWRkRm9ybVBhcmFtKCJCb2R5IiwgZXZlbnREYXRhLmJvZHkpOwogICAgdmFyIHJlc3BvbnNlID0gcGMuZXhlY3V0ZSgpLmdldCgpOwogICAgdmFyIGNvZGUgPSByZXNwb25zZS5nZXRTdGF0dXNDb2RlKCk7CiAgICBpZiAoY29kZSA9PSAyMDAgfHwgY29kZSA9PSAyMDEgfHwgY29kZSA9PSAyMDIpCiAgICAgICAgcmV0dXJuICJTZW50IjsKICAgIGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICByZXR1cm4gIkVycm9yOiAiICsgY29kZTsKICAgIH0KfQpmdW5jdGlvbiBnZXRIdG1sKCkgewogICAgdmFyIE11bHRpU3RyaW5nID0gZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gZi50b1N0cmluZygpLnNwbGl0KCdcbicpLnNsaWNlKDEsIC0xKS5qb2luKCdcbicpOwogICAgfTsKICAgIHZhciB1eCA9IE11bHRpU3RyaW5nKGZ1bmN0aW9uICgpIHsvKio8aHRtbD4KPGhlYWQ+CiAgICA8dGl0bGU+U2VuZCBtZXNzYWdlPC90aXRsZT4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMy4zLjEubWluLmpzIj48L3NjcmlwdD4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4zLjcvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgo8L2hlYWQ+Cjxib2R5IGNsYXNzPSJiZy1saWdodCI+CiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgICAgIDxkaXYgY2xhc3M9InJvdyIgc3R5bGU9Im1hcmdpbjoxMDBweDsiPgogICAgICAgICAgICA8aDI+U2VuZCBtZXNzYWdlPC9oMj4KICAgICAgICAgICAgPHRleHRhcmVhIGlkPSJtZXNzYWdlIiBwbGFjZWhvbGRlcj0iTWVzc2FnZSIgYXV0b2ZvY3VzPSJhdXRvZm9jdXMiIG9uYmx1cj0ibWVzc2FnZUJsdXIoKSIgb25mb2N1cz0ibWVzc2FnZUZvY3VzZWQoKSIgY2xhc3M9ImZvcm0tY29udHJvbCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MTZweDsgbWluLXdpZHRoOjE1MHB4OyI+PC90ZXh0YXJlYT4KICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJzZW5kQ2xpY2soKSIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgc3R5bGU9IndpZHRoOjE1MHB4OyI+U2VuZDwvYnV0dG9uPgogICAgICAgICAgICA8ZGl2IGlkPSJzdGF0dXMiIHN0eWxlPSJtYXJnaW4tbGVmdDozMnB4OyI+PC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgIDxzY3JpcHQ+CiAgICAgICAgZnVuY3Rpb24gbWVzc2FnZUZvY3VzZWQoKSB7CiAgICAgICAgICAgICQoJyNzdGF0dXMnKS50ZXh0KCcnKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHNlbmRDbGljaygpIHsKICAgICAgICAgICAgdmFyIG1zZyA9ICQoJyNtZXNzYWdlJykudmFsKCk7CiAgICAgICAgICAgIGlmICghbXNnKSB7CiAgICAgICAgICAgICAgICAkKCcjc3RhdHVzJykudGV4dCgnV3JpdGUgc29tZSB0ZXh0Jyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJCgnI3N0YXR1cycpLnRleHQoJ1NlbmRpbmcuLi4nKTsKICAgICAgICAgICAgdmFyIHVybCA9ICcnOwogICAgICAgICAgICAkLnBvc3QodXJsLCBKU09OLnN0cmluZ2lmeSh7IG1zZzogbXNnIH0pLCBmdW5jdGlvbiAoZGF0YSwgZXJyb3IpIHsKICAgICAgICAgICAgICAgICQoJyNzdGF0dXMnKS50ZXh0KGRhdGEpOwogICAgICAgICAgICB9KS5mYWlsKAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKGVycm9yKSB7ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAkKCcjc3RhdHVzJykudGV4dCgnRXJyb3IgY29kZTogJyArIGVycm9yLnN0YXR1cyk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+CiAqKi99KTsKCiAgICByZXR1cm4gdXg7Cn0=",
        "code_type": "code",
        "cpus": 0.1,
        "memory": 128,
        "timeout": 60,
        "pre_warm": 0,
        "handler": "run",
        "public": true,
        "runtime": "nashorn",
        "provider": {
            "id": "#{Provider /root/default-laser id}",
            "locations": []
        },
        "periodic_info": {},
        "secrets": [],
        "apiendpoints": []
    }
}
