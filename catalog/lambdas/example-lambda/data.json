{
  "context": {},
  "config": {},
  "options": {
    "_": [
      "apply"
    ],
    "d": "./example-lambda/bundle",
    "directory": "./example-lambda/bundle",
    "render-bundle": true,
    "renderBundle": true,
    "$0": "/Users/ericgf/Workspace/gestalt-fog-cli/cli/bin/fog"
  },
  "resources": [
    {
      "resource_type": "Gestalt::Resource::Node::Lambda",
      "name": "lambda1-nodejs",
      "description": "Calls a sequence of downstream URLs and returns the result",
      "properties": {
        "apiendpoints": [],
        "provider": {
          "id": "#{Provider #{Config laser_provider}}",
          "locations": []
        },
        "secrets": [],
        "public": true,
        "pre_warm": 0,
        "code": "Y29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3JlcXVlc3QtcHJvbWlzZS1uYXRpdmUnKTsKCm1vZHVsZS5leHBvcnRzLmhhbmRsZXIgPSBhc3luYyAoZXZlbnQsIGNvbnRleHQsIGNhbGxiYWNrKSA9PiB7CgogICAgY29uc29sZS5sb2coYGNvbnRleHQ6ICR7Y29udGV4dH1gKTsKICAgIGNvbnNvbGUubG9nKGBldmVudDogJHtldmVudH1gKTsKCiAgICBldmVudCA9IChldmVudCAmJiBldmVudC5sZW5ndGggPiAwKSA/IEpTT04ucGFyc2UoZXZlbnQpIDoge307CiAgICBjb250ZXh0ID0gKGNvbnRleHQgJiYgY29udGV4dC5sZW5ndGggPiAwKSA/IEpTT04ucGFyc2UoY29udGV4dCkgOiB7fTsKCiAgICBpZiAoY29udGV4dC5tZXRob2QgPT0gJ0dFVCcpIHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IHsKICAgICAgICAgICAgc3RhdHVzQ29kZTogMjAwLAogICAgICAgICAgICBoZWFkZXJzOiB7fSwKICAgICAgICAgICAgYm9keTogZ2V0SHRtbCgpCiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHJlc3BvbnNlKTsKICAgIH0KCiAgICBpZiAoY29udGV4dC5tZXRob2QgPT0gJ1BPU1QnKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIGF3YWl0IGRvUG9zdChjb250ZXh0LCBldmVudCkpOwogICAgfQoKICAgIGNvbnN0IHJlc3BvbnNlID0gewogICAgICAgIHN0YXR1c0NvZGU6IDUwMCwKICAgICAgICBoZWFkZXJzOiB7fSwKICAgICAgICBib2R5OiBFcnJvcigpLnN0YWNrCiAgICB9CgogICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpOwp9OwoKCmFzeW5jIGZ1bmN0aW9uIGRvUG9zdChjb250ZXh0LCBldmVudCkgewoKICAgIC8vIHJldHVybiB7CiAgICAvLyAgICAgc3RhdHVzQ29kZTogMjAwLAogICAgLy8gICAgIGhlYWRlcnM6IHt9LAogICAgLy8gICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgIC8vICAgICAgICAgZXZlbnQ6IGV2ZW50CiAgICAvLyAgICAgfSkKICAgIC8vIH07CgogICAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuRE9XTlNUUkVBTV9VUkw7CiAgICBjb25zdCBvcHRpb25zID0gewogICAgICAgIG1ldGhvZDogcHJvY2Vzcy5lbnYuRE9XTlNUUkVBTV9IVFRQX01FVEhPRCwKICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZSwKICAgICAgICBoZWFkZXJzOiB7ICdBY2NlcHQnOiAndGV4dC9wbGFpbicgfSwgLy9jb250ZXh0LmhlYWRlcnMgfHwge30sCiAgICAgICAgdGltZW91dDogMTAwMDAsCiAgICAgICAgLy8gYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgIC8vICAgICBjb250ZXh0OiBjb250ZXh0LAogICAgICAgIC8vICAgICBldmVudDogZXZlbnQKICAgICAgICAvLyB9KQogICAgfQoKICAgIGlmIChvcHRpb25zLm1ldGhvZCAhPSAnR0VUJykgewogICAgICAgIG9wdGlvbnMuYm9keSA9IGV2ZW50OwogICAgfQoKICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTsKCiAgICBjb25zb2xlLmxvZyhgSW52b2tpbmcgJHt1cmx9Li4uYCkKCiAgICBjb25zdCBzdW1tYXJ5ID0gW107CgogICAgdHJ5IHsKCiAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IHJlcXVlc3QoeyB1cmk6IHVybCwgLi4ub3B0aW9ucyB9KTsKCiAgICAgICAgY29uc3QgZWxhcHNlZCA9IERhdGUubm93KCkgLSBzdGFydDsKCiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3AuYm9keTogJyArIHJlc3AuYm9keSk7CiAgICAgICAgY29uc29sZS5sb2coJ3R5cGVvZiByZXNwLmJvZHk6ICcgKyAodHlwZW9mIHJlc3AuYm9keSkpOwogICAgICAgIGNvbnNvbGUubG9nKGAke3VybH0gcmV0dXJuZWQgYSAke3Jlc3Auc3RhdHVzQ29kZX0gYW5kIHRvb2sgJHtlbGFwc2VkfSBtcy4uLmApCgogICAgICAgIHN1bW1hcnkucHVzaCh7CiAgICAgICAgICAgIHRpbWVzdGFtcDogc3RhcnQsCiAgICAgICAgICAgIGVsYXBzZWQ6IGVsYXBzZWQsCiAgICAgICAgICAgIGRvd25zdHJlYW1fdXJsOiB1cmwsCiAgICAgICAgICAgIGRvd25zdHJlYW1fc3RhdHVzQ29kZTogcmVzcC5zdGF0dXNDb2RlLAogICAgICAgICAgICBkb3duc3RyZWFtX2hlYWRlcnM6IHJlc3AuaGVhZGVycywKICAgICAgICAgICAgZG93bnN0cmVhbV9yZXNwb25zZTogcmVzcC5ib2R5CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDIwMCwKICAgICAgICAgICAgaGVhZGVyczoge30sCiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHN1bW1hcnksIG51bGwsIDIpCiAgICAgICAgfTsKCiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBzdGF0dXNDb2RlOiA1MDAsCiAgICAgICAgICAgIGhlYWRlcnM6IHt9LAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICBlcnJvcjogZXJyLnN0YWNrCiAgICAgICAgICAgIH0pCiAgICAgICAgfTsKICAgIH0KfQoKCmZ1bmN0aW9uIGdldEh0bWwoKSB7CiAgICByZXR1cm4gYAogICAgPGh0bWw+CiAgICA8aGVhZD4KICAgICAgICA8dGl0bGU+JHtwcm9jZXNzLmVudi5USVRMRSB8fCAnUmVxdWVzdCB0byBQcm92aXNpb24gbmV3IFZNJ308L3RpdGxlPgogICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMy4zLjEubWluLmpzIj48L3NjcmlwdD4KICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzMuMy43L2Nzcy9ib290c3RyYXAubWluLmNzcyIgLz4KICAgIDwvaGVhZD4KICAgIDxib2R5IGNsYXNzPSJiZy1saWdodCI+CiAgICAgICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyIgc3R5bGU9Im1hcmdpbjoxMDBweDsiPgogICAgICAgICAgICAgICAgICAgIDxmb3JtIGlkPSJmb3JtMSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxoMj4ke3Byb2Nlc3MuZW52LkZPUk1fVElUTEUgfHwgJ0RlZmF1bHQgdGl0bGUgKHJlcGxhY2UgdXNpbmcgRk9STV9USVRMRSB2YXJpYWJsZSknfTwvaDI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBpZD0ibmFtZSIgbmFtZT0ibmFtZSIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9Ik5hbWUiIGNsYXNzPSJmb3JtLWNvbnRyb2wiICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxNnB4OyBtaW4td2lkdGg6MTUwcHg7Ij48L2lucHV0PgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9Im51bV9pbnN0YW5jZXMiIG5hbWU9Im51bV9pbnN0YW5jZXMiIHR5cGU9Im51bWJlciIgcGxhY2Vob2xkZXI9Ik51bWJlciBvZiBJbnN0YW5jZXMiIGNsYXNzPSJmb3JtLWNvbnRyb2wiICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxNnB4OyBtaW4td2lkdGg6MTUwcHg7Ij48L2lucHV0PgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9ImNwdXMiIG5hbWU9ImNwdXMiIHR5cGU9Im51bWJlciIgcGxhY2Vob2xkZXI9IkNQVXMiIGNsYXNzPSJmb3JtLWNvbnRyb2wiICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxNnB4OyBtaW4td2lkdGg6MTUwcHg7Ij48L2lucHV0PgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9Im1lbW9yeSIgbmFtZT0ibWVtb3J5IiB0eXBlPSJudW1iZXIiIHBsYWNlaG9sZGVyPSJNZW1vcnkgKEdpQikiIGNsYXNzPSJmb3JtLWNvbnRyb2wiICBzdHlsZT0ibWFyZ2luLWJvdHRvbToxNnB4OyBtaW4td2lkdGg6MTUwcHg7Ij48L2lucHV0PgoKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmFkaW8iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0ib3NfdHlwZSIgdmFsdWU9IlJIRUwiIGNoZWNrZWQ+UkhFTCA3Lng8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icmFkaW8iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0ib3NfdHlwZSIgdmFsdWU9IldJTkRPV1MiPldpbmRvd3MgMTAgUHJvZmVzc2lvbmFsPC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImNoZWNrYm94LWlubGluZSI+PGlucHV0IG5hbWU9InNzZF9zdG9yYWdlIiB0eXBlPSJjaGVja2JveCIgdmFsdWU9IiI+U1NEIFN0b3JhZ2U8L2xhYmVsPgoKICAgICAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhIGlkPSJ1c2VyX2RhdGEiIG5hbWU9InVzZXJfZGF0YSIgcGxhY2Vob2xkZXI9IlVzZXIgRGF0YSIgYXV0b2ZvY3VzPSJhdXRvZm9jdXMiIG9uYmx1cj0ibWVzc2FnZUJsdXIoKSIgb25mb2N1cz0ibWVzc2FnZUZvY3VzZWQoKSIgY2xhc3M9ImZvcm0tY29udHJvbCIgc3R5bGU9Im1hcmdpbi1ib3R0b206MTZweDsgbWluLXdpZHRoOjE1MHB4OyI+PC90ZXh0YXJlYT4KICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPgoKICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InNlbmRDbGljaygpIiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IiBzdHlsZT0id2lkdGg6MjAwcHg7Ij5Jbml0aWF0ZSBWTSBQcm92aXNpb25pbmc8L2J1dHRvbj4KCiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0ic3RhdHVzIiBzdHlsZT0ibWFyZ2luLWxlZnQ6MzJweDsiPjwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAKICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAgICAgZnVuY3Rpb24gbWVzc2FnZUZvY3VzZWQoKSB7CiAgICAgICAgICAgICAgICAkKCcjc3RhdHVzJykudGV4dCgnJyk7CiAgICAgICAgICAgIH0KICAgIAogICAgICAgICAgICBmdW5jdGlvbiBzZW5kQ2xpY2soKSB7CiAgICAgICAgICAgICAgICB2YXIgbXNnID0ge307CiAgICAgICAgICAgICAgICAkLmVhY2goJCgnI2Zvcm0xJykuc2VyaWFsaXplQXJyYXkoKSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIG1zZ1t0aGlzLm5hbWVdID0gdGhpcy52YWx1ZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICAgICAgJCgnI3N0YXR1cycpLnRleHQoJ1NlbmRpbmcuLi4nKTsKICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnLi9sYW1iZGExJzsKICAgICAgICAgICAgICAgICQucG9zdCh1cmwsIEpTT04uc3RyaW5naWZ5KG1zZyksIGZ1bmN0aW9uIChkYXRhLCBlcnJvcikgewogICAgICAgICAgICAgICAgICAgICQoJyNzdGF0dXMnKS50ZXh0KGRhdGEpOwogICAgICAgICAgICAgICAgfSkuZmFpbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyb3IpIHsgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAkKCcjc3RhdHVzJykudGV4dCgnRXJyb3IgY29kZTogJyArIGVycm9yLnN0YXR1cyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCgogICAgICAgIDwvc2NyaXB0PgogICAgPC9ib2R5PgogICAgPC9odG1sPiAgICAKICAgIGAKfQoK",
        "cpus": 0.1,
        "code_type": "code",
        "headers": {
          "Accept": "text/plain",
          "Content-Type": "text/html"
        },
        "periodic_info": {},
        "timeout": 60,
        "handler": "handler",
        "runtime": "nodejs",
        "env": {
          "FORM_TITLE": "VM Provisioning Action",
          "DOWNSTREAM_HTTP_METHOD": "GET",
          "DOWNSTREAM_URL": "http://test"
        },
        "memory": 128
      }
    }
  ]
}
